<% require 'redcarpet' %>
<% renderer = Redcarpet::Render::HTML.new %>
<% markdown = Redcarpet::Markdown.new(Redcarpet::Render::HTML, autolink: true) %>

<div class="container">
	<h2>Song</h2>
	<div class="row">
		<div class="col-md-12">
		  <div class="col-md-6 col-md-push-6 song-details">
		      <h3>
		      	<span>
		      		<%= @song.title %>
		      	</span>
		      </h3>
		      <br />
		      <%= @song.description %>

		      <%= link_to "Delete", song_path, method: :delete, data:{confirm: "You sure?"} %>
		  </div>
		  <div class="col-md-6 col-md-pull-6 song-video">
		    <div class="embed-responsive embed-responsive-16by9">
		      <iframe class="embed-video" src="<%= @song.url %>" allowfullscreen></iframe>
		    </div>
		  </div>
		</div>
	</div>
</div>

<% count = 0 %>

<div class="container">
	<div class="row">
		<div class="col-md-12">
			<div class="col-md-6">
				<h3>Samples</h3>
				<% @song.samples.sort_by {|s| s.starting_time_i}.each do |sample| %>
				    <div class="sample">
				    	<button type="button" class="btn btn-primary modal-btn" data-toggle="modal" data-target=".modal-lg-<%= count %>"><h4><%= sample.starting_time %><% if !sample.other_times.nil? %>, <%= sample.other_times %><% end %> - <%= sample.artist %></h4></button>
				    	<div class="modal fade modal-lg-<%= count %>" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
						  <div class="modal-dialog modal-lg">
						    <div class="modal-content">
						    	<h2 class="modal-title" id="myModalLabel"><%= sample.starting_time %><% if !sample.other_times.nil? %>, <%= sample.other_times %><% end %> - <%= sample.artist %></h2>
						      	<h4><%= markdown.render(sample.description).html_safe %></h4>
						      	<% if !sample.url.nil? %>
						      	<div class="embed-responsive embed-responsive-16by9">
							      <iframe class="embed-video" src="<%= sample.url %>?html5=1" allowfullscreen></iframe>
							    </div>
							    <% end %>
						    </div>
						  </div>
						</div>
				    </div>
				    <% count += 1 %>
				<% end %>
			</div>
			<div class="col-md-6">
				<h3>Other elements</h3>
				<% @song.elements.sort_by {|s| s.starting_time_i}.each do |element| %>
				    <div class="element">
				    	<button type="button" class="btn btn-primary modal-btn" data-toggle="modal" data-target=".modal-lg-<%= count %>"><h4><%= element.starting_time %> - <%= element.source %></h4></button>
				    	<div class="modal fade modal-lg-<%= count %>" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
						  <div class="modal-dialog modal-lg">
						    <div class="modal-content">
						    	<h2 class="modal-title" id="myModalLabel"><%= element.starting_time %><% if !element.other_times.nil? %>, <%= element.other_times %><% end %> - <%= element.source %></h2>
						      	<h4><%= markdown.render(element.description).html_safe %></h4>
						      	<!-- <div class="embed-responsive embed-responsive-16by9">
							      <iframe class="embed-video" src="?html5=1" allowfullscreen></iframe>
							    </div> -->
						    </div>
						  </div>
						</div>
				    </div>
				    <% count += 1 %>
				<% end %>
			</div>
		</div>
	</div>
</div>

